<!DOCTYPE html>
<html lang="ko"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v9.1.6 <https://hydejack.com/>
-->







<head>
  






  
    

<title>AWS EC2ì—ì„œ Nginxì™€ Certbotìœ¼ë¡œ Let's encrypt SSL ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸° | NicoDora</title>
<meta name="description" content="AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ Nginxì™€ Certbotì„ ì‚¬ìš©í•˜ì—¬ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ê³  ìë™ê°±ì‹ ê¹Œì§€ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.
">
<link rel="canonical" href="http://localhost:4000/aws/2025/03/07/AWS-EC2%EC%97%90%EC%84%9C-Nginx%EC%99%80-Certbot%EC%9C%BC%EB%A1%9C-Lets-encrypt-SSL-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EB%B0%9C%EA%B8%89%ED%95%98%EA%B8%B0.html">

  

  



  <meta name="theme-color" content="rgb(25,55,71)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="NicoDora">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="NicoDora">

<meta name="generator" content="Hydejack v9.1.6" />


<link rel="alternate" href="http://localhost:4000/aws/2025/03/07/AWS-EC2%EC%97%90%EC%84%9C-Nginx%EC%99%80-Certbot%EC%9C%BC%EB%A1%9C-Lets-encrypt-SSL-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EB%B0%9C%EA%B8%89%ED%95%98%EA%B8%B0.html" hreflang="ko">



<link rel="shortcut icon"    href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com">


  <link rel="dns-prefetch" href="https://www.google-analytics.com">


<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">
  <link rel="dns-prefetch" href="/assets/js/search-worker-9.1.6.js" as="worker" id="_hrefSearch">






<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2025-03-07T14:50:15+09:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload">



  <style id="_pageStyle">

html{--accent-color: rgb(79,177,186);--accent-color-faded: rgba(79, 177, 186, 0.5);--accent-color-highlight: rgba(79, 177, 186, 0.1);--accent-color-darkened: #409ba3;--theme-color: rgb(25,55,71);--dark-mode-body-bg: hsl(200.8695652174, 5.9895833333%, 17.5%);--dark-mode-border-color: hsl(200.8695652174, 5.9895833333%, 22.5%)}
</style>


<!--<![endif]-->




<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="/assets/js/sidebar-folder.js"></script>


  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D9VF7EQWGG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-D9VF7EQWGG');
</script>
</head>

<body class="dark-mode no-break-layout">
  
<script>
  window._sunrise = 6;
  window._sunset =  18;
  !function(e,s){var d="light-mode",o="dark-mode",a=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(a=a<=e._sunrise||a>=e._sunset?o:d)==o?d:o,s.body.classList.add(a),s.body.classList.remove(e))}(window,document);

</script>



<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/aws/">aws</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/aws/2025/">2025</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/aws/2025/03/">03</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/aws/2025/03/07/">07</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°.html</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-aws-2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        AWS EC2ì—ì„œ Nginxì™€ Certbotìœ¼ë¡œ Let's encrypt SSL ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2025-03-07T14:31:00+09:00">2025-03-07 14:31</time> in <a href="/aws/" class="flip-title">AWS</a> 
      </span>
      
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          


<img
  
    src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/letsencrypt-logo.png"
  
  alt="AWS EC2ì—ì„œ Nginxì™€ Certbotìœ¼ë¡œ Let's encrypt SSL ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

        </div>
      
      
    

    



  
    <p class="note-sm" >
      AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ Nginxì™€ Certbotì„ ì‚¬ìš©í•˜ì—¬ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ê³  ìë™ê°±ì‹ ê¹Œì§€ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.

    </p>
  


  </header>

  
    <ol id="markdown-toc">
  <li><a href="#ë“¤ì–´ê°€ê¸°-ì „ì—" id="markdown-toc-ë“¤ì–´ê°€ê¸°-ì „ì—">ë“¤ì–´ê°€ê¸° ì „ì—</a></li>
  <li><a href="#ì‚¬ì „-ì¤€ë¹„-í™˜ê²½" id="markdown-toc-ì‚¬ì „-ì¤€ë¹„-í™˜ê²½">ì‚¬ì „ ì¤€ë¹„ í™˜ê²½</a></li>
  <li><a href="#dns-ì²´í¬" id="markdown-toc-dns-ì²´í¬">DNS ì²´í¬</a></li>
  <li><a href="#docker-composeyaml-ì‘ì„±" id="markdown-toc-docker-composeyaml-ì‘ì„±">docker-compose.yaml ì‘ì„±</a></li>
  <li><a href="#nginxconf-íŒŒì¼-ì‘ì„±" id="markdown-toc-nginxconf-íŒŒì¼-ì‘ì„±">nginx.conf íŒŒì¼ ì‘ì„±</a></li>
  <li><a href="#nginx-ì„ì‹œ-ì‹¤í–‰" id="markdown-toc-nginx-ì„ì‹œ-ì‹¤í–‰">Nginx ì„ì‹œ ì‹¤í–‰</a></li>
  <li><a href="#certbotìœ¼ë¡œ-ssl-ì¸ì¦ì„œ-ë°œê¸‰" id="markdown-toc-certbotìœ¼ë¡œ-ssl-ì¸ì¦ì„œ-ë°œê¸‰">Certbotìœ¼ë¡œ SSL ì¸ì¦ì„œ ë°œê¸‰</a></li>
  <li><a href="#docker-composeyaml-íŒŒì¼-ì—…ë°ì´íŠ¸" id="markdown-toc-docker-composeyaml-íŒŒì¼-ì—…ë°ì´íŠ¸">docker-compose.yaml íŒŒì¼ ì—…ë°ì´íŠ¸</a></li>
  <li><a href="#nginxconf-íŒŒì¼-ì—…ë°ì´íŠ¸" id="markdown-toc-nginxconf-íŒŒì¼-ì—…ë°ì´íŠ¸">nginx.conf íŒŒì¼ ì—…ë°ì´íŠ¸</a></li>
  <li><a href="#docker-compose-ì‹¤í–‰" id="markdown-toc-docker-compose-ì‹¤í–‰">docker-compose ì‹¤í–‰</a></li>
  <li><a href="#ë§ˆì¹˜ë©°" id="markdown-toc-ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°</a></li>
</ol>

<h2 id="ë“¤ì–´ê°€ê¸°-ì „ì—">ë“¤ì–´ê°€ê¸° ì „ì—</h2>

<p>í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰ì¤‘ì— ë°±ì—”ë“œ ê°œë°œì„œë²„ë¥¼ ë°°í¬í•´ì•¼ í•  ìƒí™©ì´ ì™€ì„œ ê¸‰í•˜ê²Œ EC2ì™€ RDSë¥¼ ë§Œë“¤ê³  SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ìœ¼ë ¤ê³  í•  ë•Œ ê°‘ìê¸° ì´ëŸ° ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. <b>â€œì´ê±° ë¸”ë¡œê·¸ì— ì •ë¦¬í•´ë‘ë©´ ì¢‹ê² ë‹¤!â€</b> ë¼ê³ â€¦
<br />
<br />
ë°±ì—”ë“œ ì„œë²„ì˜ ë°°í¬ê³¼ì •ì„ A to Zë¡œ ì •ë¦¬í•˜ë©´ ì¢‹ê² ì§€ë§Œâ€¦<br />
ì´ë¯¸ AWS ì„¸íŒ…ì€ ëŒ€ë¶€ë¶„ ì™„ë£Œëœ ìƒíƒœë¼ì„œ, SSL ì¸ì¦ì„œ ë°œê¸‰ê³¼ì •ë§Œ ì •ë¦¬í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.
<br />
<br />
ì‚¬ì‹¤ SSL ì¸ì¦ì„œ ë°œê¸‰ ë¶€ë¶„ë„ ì²˜ìŒ ì ìš©í•˜ëŠ” ì‚¬ëŒ ì…ì¥ì—ì„œëŠ” í—·ê°ˆë¦´ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ë§ì•„ì„œ, ë¸”ë¡œê·¸ì— ì •ë¦¬í•´ë‘ë©´ ë¶„ëª… ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ ë„ì›€ì´ ë  ê±°ë¼ê³  ìƒê°í•©ë‹ˆë‹¤! (ì‹¤ì œë¡œ ì €ë„ ì²˜ìŒì—ëŠ” ë§ì´ í—¤ë§¸ê±°ë“ ìš”â€¦ ã…ã…;;)</p>

<h2 id="ì‚¬ì „-ì¤€ë¹„-í™˜ê²½">ì‚¬ì „ ì¤€ë¹„ í™˜ê²½</h2>

<p>ì¼ë‹¨ ì €ì˜ í™˜ê²½ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
<br />
<br />
<img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/dev-server-architecture1.png" alt="dev ì„œë²„ ì•„í‚¤í…ì³1" /></p>

<ul>
  <li>AWS EC2 ì¸ìŠ¤í„´ìŠ¤ (Ubuntu)</li>
  <li>ë„ë©”ì¸ êµ¬ë§¤ ë° ì—°ê²° (ê°€ë¹„ì•„, AWS Route53)</li>
  <li>EC2ì—ì„œ Dockerë¡œ ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰
<br />
<br />
<br />
í•´ë‹¹ í™˜ê²½ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•´ë³´ë ¤ í•©ë‹ˆë‹¤.
<br />
<br />
<img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/dev-server-architecture2.png" alt="dev ì„œë²„ ì•„í‚¤í…ì³2" /></li>
</ul>

<p><br />
ì—¬ê¸°ì„œ ë„ë©”ì¸ êµ¬ë§¤ëŠ” í•„ìˆ˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— EC2 ì¸ìŠ¤í„´ìŠ¤ì— í• ë‹¹ëœ í¼ë¸”ë¦­ IPv4 ì£¼ì†Œë¥¼ ì‚¬ìš©í•´ë„ ê´œì°®ì§€ë§Œ, ì €ëŠ” ë„ë©”ì¸ì„ êµ¬ë§¤í–ˆê¸° ë•Œë¬¸ì— ë„ë©”ì¸ì„ ì‚¬ìš©í•´ì„œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.
<br />
<br />
Dockerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  EC2 ì¸ìŠ¤í„´ìŠ¤ì— Nginxë¥¼ ì„¤ì¹˜í•˜ê³  SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ëŠ” ë°©ë²•ë„ ìˆì§€ë§Œ, Dockerë¥¼ ì‚¬ìš©í•˜ë©´ ë” ê°„í¸í•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì €ëŠ” Docker ì‚¬ìš©ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.
<br />
<br />
EC2 ì¸ìŠ¤í„´ìŠ¤ì— Docker ë° docker-compose ì„¤ì¹˜ëŠ” ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ëŒ€ë¡œ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1-1. í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ì „ ìš°ë¶„íˆ¬ ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get update

<span class="c"># 1-2. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>apt-transport-https ca-certificates curl gnupg-agent software-properties-common

<span class="c"># 1-3. Dockerì˜ ê³µì‹ GPG í‚¤ ì¶”ê°€</span>
<span class="nv">$ </span>curl <span class="nt">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg | <span class="nb">sudo </span>apt-key add -

<span class="c"># 1-4. Dockerì˜ ê³µì‹ apt ì €ì¥ì†Œ ì¶”ê°€</span>
<span class="nv">$ </span><span class="nb">sudo </span>add-apt-repository <span class="s2">"deb [arch=amd64] https://download.docker.com/linux/ubuntu </span><span class="si">$(</span>lsb_release <span class="nt">-cs</span><span class="si">)</span><span class="s2"> stable"</span>

<span class="c"># 1-5. ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get update

<span class="c"># 1-6. Docker ì„¤ì¹˜</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>docker-ce docker-ce-cli containerd.io

<span class="c"># 2-1. Docker Compose ì„¤ì¹˜</span>
<span class="nv">$ </span><span class="nb">sudo </span>curl <span class="nt">-L</span> <span class="s2">"https://github.com/docker/compose/releases/download/1.27.4/docker-compose-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-s</span><span class="si">)</span><span class="s2">-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span><span class="s2">"</span> <span class="nt">-o</span> /usr/local/bin/docker-compose

<span class="c"># 2-2. ë‹¤ìš´ë¡œë“œ í•œ íŒŒì¼ì— ê¶Œí•œ ì„¤ì •</span>
<span class="nv">$ </span><span class="nb">sudo chmod</span> +x /usr/local/bin/docker-compose

<span class="c"># 2-3. Docker Compose ë²„ì „ í™•ì¸ (ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸)</span>
<span class="nv">$ </span>docker-compose <span class="nt">--version</span>
</code></pre></div></div>

<p><a href="https://velog.io/@jjeongdong/Devops-Docker-Compose%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-EC2%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EB%B0%B0%ED%8F%AC#ec2-linux%EC%97%90-docker--docker-compose-%EC%84%A4%EC%B9%98">ì¶œì²˜</a></p>

<h2 id="dns-ì²´í¬">DNS ì²´í¬</h2>

<p>ë„ë©”ì¸ì„ êµ¬ë§¤í•˜ì‹  ë¶„ë“¤ì´ë¼ë©´ DNSê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì…”ì•¼ í•©ë‹ˆë‹¤.<br />
í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dig {ë„ë©”ì¸}</span>
<span class="nv">$ </span>dig dev.honeymoa.kr
</code></pre></div></div>

<p>ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ <code class="language-plaintext highlighter-rouge">status</code>ê°€ <code class="language-plaintext highlighter-rouge">NOERROR</code>ë¡œ ë‚˜ì˜¤ê³ , <code class="language-plaintext highlighter-rouge">ANSWER SECTION</code>ì— ë„ë©”ì¸ê³¼ ì—°ê²°ëœ IP ì£¼ì†Œê°€ ë‚˜ì˜µë‹ˆë‹¤.
<img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/dns-check.png" alt="DNS ì„¤ì • í™•ì¸" />
<br />
<br />
í˜¹ì‹œë‚˜ <code class="language-plaintext highlighter-rouge">status</code>ê°€ <code class="language-plaintext highlighter-rouge">NXDOMAIN</code>ìœ¼ë¡œ ë‚˜ì˜¤ì‹ ë‹¤ë©´ ë„ë©”ì¸ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆê±°ë‚˜, DNS ì„œë²„ì— ë„ë©”ì¸ ì •ë³´ê°€ ì „íŒŒë˜ì§€ ì•Šì€ ê²ƒì…ë‹ˆë‹¤.<br />
ë‹¤ì‹œí•œë²ˆ ë„ë©”ì¸ ì„¤ì •ì„ í™•ì¸í•˜ì‹œê³ , ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•˜ì…¨ë‹¤ë©´ DNS ì„œë²„ì— ë„ë©”ì¸ ì •ë³´ê°€ ì „íŒŒë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>

<h2 id="docker-composeyaml-ì‘ì„±">docker-compose.yaml ì‘ì„±</h2>

<p><span style="color:#808080"> ğŸ“ <em>ì§€ê¸ˆë¶€í„° íŒŒì¼ ì‘ì„±ì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í–ˆì„ ë•Œì˜ <b>ë£¨íŠ¸ ë””ë ‰í† ë¦¬(/home/ubuntu)</b>ì—ì„œ ì§„í–‰ë˜ë‹ˆ ìœ ì˜í•´ì£¼ì„¸ìš”!</em> </span></p>

<p>ë ˆê±°ì‹œí•œ ë°©ë²•ìœ¼ë¡œ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰í•˜ë ¤ë©´ EC2 ì¸ìŠ¤í„´ìŠ¤ì— Nginxë¥¼ ì„¤ì¹˜í•˜ê³ , Certbotì„ ì„¤ì¹˜í•´ì•¼ í•˜ì§€ë§Œ,<br />
Dockerë¥¼ ì‚¬ìš©í•˜ë©´ Nginxì™€ Certbotì„ ì»¨í…Œì´ë„ˆë¡œ í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br />
<br />
ì•„ë˜ì™€ ê°™ì´ <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì„ ì‘ì„±í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># file: "docker-compose.yaml"</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.7'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">nginx</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.15-alpine</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">80:80'</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx/nginx.conf:/etc/nginx/nginx.conf</span>
      <span class="pi">-</span> <span class="s">./nginx/www/certbot:/var/www/certbot</span>
      <span class="pi">-</span> <span class="s">./nginx/logs:/var/log/nginx</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">certbot</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">certbot/certbot</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">certbot</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx/www/certbot:/var/www/certbot</span>
      <span class="pi">-</span> <span class="s">./nginx/ssl:/etc/letsencrypt</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">certonly --webroot --webroot-path=/var/www/certbot -d {ë„ë©”ì¸}</span>
</code></pre></div></div>
<p><br />
ê°„ë‹¨í•˜ê²Œ ìœ„ ì½”ë“œì— ëŒ€í•´ì„œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nginx</code> ì„œë¹„ìŠ¤
    <ul>
      <li><code class="language-plaintext highlighter-rouge">image</code>: ì‚¬ìš©í•  Nginx ì´ë¯¸ì§€</li>
      <li><code class="language-plaintext highlighter-rouge">container_name</code>: ì»¨í…Œì´ë„ˆ ì´ë¦„</li>
      <li><code class="language-plaintext highlighter-rouge">ports</code>: í˜¸ìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸ ë§¤í•‘ (80:80)</li>
      <li><code class="language-plaintext highlighter-rouge">volumes</code>: í˜¸ìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆì˜ ë””ë ‰í† ë¦¬ ë§¤í•‘</li>
      <li><code class="language-plaintext highlighter-rouge">restart</code>: ì»¨í…Œì´ë„ˆê°€ ì¤‘ì§€ë˜ì—ˆì„ ë•Œ ì¬ì‹œì‘í•  ì •ì±… ì„¤ì •</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">certbot</code> ì„œë¹„ìŠ¤
    <ul>
      <li><code class="language-plaintext highlighter-rouge">image</code>: ì‚¬ìš©í•  Certbot ì´ë¯¸ì§€</li>
      <li><code class="language-plaintext highlighter-rouge">container_name</code>: ì»¨í…Œì´ë„ˆ ì´ë¦„</li>
      <li><code class="language-plaintext highlighter-rouge">volumes</code>: í˜¸ìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆì˜ ë””ë ‰í† ë¦¬ ë§¤í•‘</li>
      <li><code class="language-plaintext highlighter-rouge">command</code>: Certbot ëª…ë ¹ì–´ (ì¸ì¦ì„œ ë°œê¸‰)
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h2 id="nginxconf-íŒŒì¼-ì‘ì„±">nginx.conf íŒŒì¼ ì‘ì„±</h2>

<p><code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì—ì„œ ë³¼ë¥¨ ë§ˆìš´íŠ¸ ì„¤ì •ì„ ë³´ë©´ <code class="language-plaintext highlighter-rouge">nginx/</code> ë””ë ‰í† ë¦¬ê°€ í•„ìš”í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br /></p>

<p class="note">ì „ì²´ì ì¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/ubuntu
â”œâ”€â”€ docker-compose.yaml
â”œâ”€â”€ nginx
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”œâ”€â”€ ssl/
â”‚   â”‚   â”œâ”€â”€ (certbot ì¸ì¦ì„œ)
â”‚   â”œâ”€â”€ logs/
â”‚   â””â”€â”€ www/
â”‚       â””â”€â”€ certbot/
â””â”€â”€ .env
</code></pre></div></div>
<p><br /></p>

<p>ì•„ë˜ì™€ ê°™ì´ <b><code class="language-plaintext highlighter-rouge">nginx</code></b> ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>nginx
</code></pre></div></div>

<p><br />
ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">nginx</code> ë””ë ‰í† ë¦¬ ì•ˆì— <b><code class="language-plaintext highlighter-rouge">nginx.conf</code></b> íŒŒì¼ì„ ìƒì„±í•´ì¤ë‹ˆë‹¤.<br />
<code class="language-plaintext highlighter-rouge">nginx.conf</code> íŒŒì¼ì€ Nginxê°€ ì‹¤í–‰ë  ë•Œ ì‚¬ìš©í•˜ëŠ” ì„¤ì • íŒŒì¼ë¡œ, ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># file: "nginx/nginx.conf"</span>
<span class="k">events</span> <span class="p">{</span>
  <span class="kn">worker_connections</span> <span class="mi">1024</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span> <span class="p">{</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">dev.honeymoa.kr</span><span class="p">;</span> <span class="c1"># server_name {ë„ë©”ì¸}</span>

    <span class="kn">location</span> <span class="n">/.well-known/acme-challenge/</span> <span class="p">{</span>
      <span class="kn">root</span> <span class="n">/var/www/certbot</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
      <span class="kn">return</span> <span class="mi">404</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<details>
<summary><b>nginx.conf íŒŒì¼ ì„¤ëª…</b></summary>
<div>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">events</code> ë¸”ë¡ì—ì„œëŠ” Nginx ì‘ì—…ìê°€ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ì—°ê²° ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ <code class="language-plaintext highlighter-rouge">worker_connections 1024;</code>ëŠ” ê°ê°ì˜ ì‘ì—…ìê°€ ìµœëŒ€ 1024ê°œì˜ ì—°ê²°ì„ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì§€ì •í•©ë‹ˆë‹¤.</p>
      </li>
      <li>
        <p>ë‹¤ìŒìœ¼ë¡œ, <code class="language-plaintext highlighter-rouge">http</code> ë¸”ë¡ ë‚´ë¶€ì— ì •ì˜ëœ <code class="language-plaintext highlighter-rouge">server</code> ë¸”ë¡ì€ 80ë²ˆ í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ë©°, ë„ë©”ì¸ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p>
        <ul>
          <li>ì²« ë²ˆì§¸ <code class="language-plaintext highlighter-rouge">location</code> ë¸”ë¡ì€ <code class="language-plaintext highlighter-rouge">/.well-known/acme-challenge/</code>ê²½ë¡œì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” í•´ë‹¹ ê²½ë¡œì˜ ìš”ì²­ì— ëŒ€í•´ <code class="language-plaintext highlighter-rouge">/var/www/certbot</code> ë””ë ‰í† ë¦¬ì—ì„œ íŒŒì¼ì„ ì œê³µí•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
          <li>ë‘ ë²ˆì§¸ location ë¸”ë¡ì€ <code class="language-plaintext highlighter-rouge">/</code>ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ë‹¤ë¥¸ ìš”ì²­ì— ëŒ€í•´ 404 ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì¸ì¦ì„œ ë°œê¸‰ ê´€ë ¨ ìš”ì²­ ì™¸ì˜ ë‹¤ë¥¸ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•œ ì„¤ì •ì…ë‹ˆë‹¤.</li>
        </ul>
      </li>
    </ul>
  </div>
</details>
<p><br /></p>

<p>ë‚˜ë¨¸ì§€ <code class="language-plaintext highlighter-rouge">/nginx/www/</code>, <code class="language-plaintext highlighter-rouge">/nginx/logs/</code>, <code class="language-plaintext highlighter-rouge">/nginx/ssl/</code> ë””ë ‰í† ë¦¬ëŠ” Nginx ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.</p>

<h2 id="nginx-ì„ì‹œ-ì‹¤í–‰">Nginx ì„ì‹œ ì‹¤í–‰</h2>

<p><code class="language-plaintext highlighter-rouge">nginx.conf</code> íŒŒì¼ ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ ì´ì œ Nginxë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.
<br />
<br /></p>

<p><code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ Nginxë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.<br />
<span style="color:#808080"><em>(ë§Œì•½ <code class="language-plaintext highlighter-rouge">docker-compose</code> íŒŒì¼ì˜ ì´ë¦„ì´ ë‹¤ë¥´ë‹¤ë©´ <code class="language-plaintext highlighter-rouge">-f</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì´ë¦„ì„ ì§€ì •í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.)</em></span></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose up <span class="nt">-d</span> nginx
</code></pre></div></div>

<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/nginx-up.png" alt="nginx ì‹¤í–‰" /></p>

<p><br />
ì»¨í…Œì´ë„ˆê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë¡œê·¸ê°€ ì—†ì–´ì•¼ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœ ê²ƒì…ë‹ˆë‹¤.</span>
<span class="nv">$ </span>docker logs nginx

<span class="c"># nginx.conf íŒŒì¼ ë¬¸ë²• ê²€ì‚¬</span>
<span class="nv">$ </span>docker-compose <span class="nb">exec </span>nginx nginx <span class="nt">-t</span>

<span class="c"># nginxê°€ ì‹¤í–‰ì¤‘ì¸ì§€ í™•ì¸</span>
<span class="nv">$ </span>docker ps
</code></pre></div></div>

<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/nginx-check.png" alt="nginx ì‹¤í–‰ í™•ì¸" />
<br /></p>

<h2 id="certbotìœ¼ë¡œ-ssl-ì¸ì¦ì„œ-ë°œê¸‰">Certbotìœ¼ë¡œ SSL ì¸ì¦ì„œ ë°œê¸‰</h2>

<p>ì´ì œ Nginxê°€ ì‹¤í–‰ë˜ì—ˆìœ¼ë‹ˆ Certbotì„ ì‚¬ìš©í•˜ì—¬ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì•„ë³´ê² ìŠµë‹ˆë‹¤.<br />
1ï¸âƒ£ <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ Certbot ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose run <span class="nt">--rm</span> certbot
</code></pre></div></div>
<p><br />
2ï¸âƒ£ ê¸´ê¸‰ ê°±ì‹  ë° ë³´ì•ˆ ì•Œë¦¼ì— ì‚¬ìš©í•  ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ë¼ê³  ë‚˜ì˜¤ë‹ˆ ì ì ˆí•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Saving debug log to /var/log/letsencrypt/letsencrypt.log
Enter email address (used for urgent renewal and security notices)
 (Enter 'c' to cancel):
</code></pre></div></div>
<p><br />
3ï¸âƒ£ ì•½ê´€ì— ë™ì˜í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ”ë°, ì•½ê´€ì— ë™ì˜í•´ì•¼ ì¸ì¦ì„œ ë°œê¸‰ì´ ë˜ë‹ˆ <code class="language-plaintext highlighter-rouge">Y</code>ë¥¼ ì…ë ¥í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please read the Terms of Service at:
https://letsencrypt.org/documents/LE-SA-v1.5-February-24-2025.pdf
You must agree in order to register with the ACME server. Do you agree?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y
</code></pre></div></div>
<p><br />
4ï¸âƒ£ í™ë³´ì„± ë©”ì¼ ìˆ˜ì‹  ì—¬ë¶€ë¥¼ ë¬»ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ”ë°, ì›í•˜ì‹œëŠ” ëŒ€ë¡œ ì„ íƒí•˜ì‹œë©´ ë©ë‹ˆë‹¤.<br />
ì €ëŠ” ë©”ì¼ ìˆ˜ì‹ ì„ ì›í•˜ì§€ ì•Šì•„ì„œ <code class="language-plaintext highlighter-rouge">N</code>ì„ ì…ë ¥í–ˆìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing, once your first certificate is successfully issued, to
share your email address with the Electronic Frontier Foundation, a founding
partner of the Let's Encrypt project and the non-profit organization that
develops Certbot? We'd like to send you email about our work encrypting the web,
EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: N
</code></pre></div></div>
<p><br />
ğŸ“ <span style="color:#F08080">ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´ AWS ë³´ì•ˆ ê·¸ë£¹ì—ì„œ <code class="language-plaintext highlighter-rouge">80</code>ë²ˆ í¬íŠ¸ê°€ ì—´ë ¤ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”!</span></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Account registered.
Requesting a certificate for dev.honeymoa.kr

Certbot failed to authenticate some domains (authenticator: webroot). The Certificate Authority reported these problems:
  Domain: dev.honeymoa.kr
  Type:   connection
  Detail: 3.39.69.185: Fetching http://dev.honeymoa.kr/.well-known/acme-challenge/SLl0wrWe_5cmAZN6XAX0zq8kboOBEETuiT5WcMvSrtM: Timeout during connect (likely firewall problem)

Hint: The Certificate Authority failed to download the temporary challenge files created by Certbot. Ensure that the listed domains serve their content from the provided --webroot-path/-w and that files created there can be downloaded from the internet.

Some challenges have failed.
Ask for help or search for solutions at https://community.letsencrypt.org. See the logfile /var/log/letsencrypt/letsencrypt.log or re-run Certbot with -v for more details.
</code></pre></div></div>
<p><br />
5ï¸âƒ£ <span style="color:#32CD32">ì¸ì¦ì„œ ë°œê¸‰ì´ ì™„ë£Œë˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë©”ì‹œì§€ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.</span></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Requesting a certificate for dev.honeymoa.kr

Successfully received certificate.
Certificate is saved at: /etc/letsencrypt/live/dev.honeymoa.kr/fullchain.pem
Key is saved at:         /etc/letsencrypt/live/dev.honeymoa.kr/privkey.pem
This certificate expires on 2025-06-04.
These files will be updated when the certificate renews.

NEXT STEPS:
- The certificate will need to be renewed before it expires. Certbot can automatically renew the certificate in the background, but you may need to take steps to enable that functionality. See https://certbot.org/renewal-setup for instructions.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
If you like Certbot, please consider supporting our work by:
 * Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
 * Donating to EFF:                    https://eff.org/donate-le
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</code></pre></div></div>
<p><br />
ì¸ì¦ì„œ ë°œê¸‰ì— ì„±ê³µí•˜ë©´ <b><code class="language-plaintext highlighter-rouge">/nginx/ssl/live/{ë„ë©”ì¸}/</code></b> ë””ë ‰í† ë¦¬ ì•ˆì— ì¸ì¦ì„œì™€ ê°œì¸í‚¤ê°€ ì €ì¥ë©ë‹ˆë‹¤.<br />
ì¸ì¦ì„œì™€ ê°œì¸í‚¤ëŠ” ê°ê° <b><code class="language-plaintext highlighter-rouge">fullchain.pem</code></b>ê³¼ <b><code class="language-plaintext highlighter-rouge">privkey.pem</code></b> íŒŒì¼ì— ì €ì¥ë©ë‹ˆë‹¤.
<br />
<br />
ì¸ì¦ì„œì™€ ê°œì¸í‚¤ê°€ ì •ìƒì ìœ¼ë¡œ ë°œê¸‰ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ì¸ì¦ì„œ í™•ì¸</span>
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> /nginx/ssl/live/<span class="o">{</span>ë„ë©”ì¸<span class="o">}</span>
</code></pre></div></div>
<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/cert-check.png" alt="ì¸ì¦ì„œ í™•ì¸" />
<br /></p>

<h2 id="docker-composeyaml-íŒŒì¼-ì—…ë°ì´íŠ¸">docker-compose.yaml íŒŒì¼ ì—…ë°ì´íŠ¸</h2>

<p>ì¸ì¦ì„œ ë°œê¸‰ì´ ì™„ë£Œë˜ì—ˆìœ¼ë‹ˆ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ Nginxë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose down
</code></pre></div></div>
<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/nginx-down.png" alt="nginx ì¢…ë£Œ" />
<br />
<br />
ì´ì œ <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì„ ì™„ì„±í•´ë´…ì‹œë‹¤.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># file: "docker-compose.yaml"</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">honey-moa-dev</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nicodora/honey-moa-dev:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">honey-moa-dev</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.env</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">3000:3000'</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">honey-moa-dev-network</span>

  <span class="na">nginx</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.15-alpine</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">80:80'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">443:443'</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx/nginx.conf:/etc/nginx/nginx.conf</span> <span class="c1"># nginx.conf íŒŒì¼</span>
      <span class="pi">-</span> <span class="s">./nginx/www/certbot:/var/www/certbot</span> <span class="c1"># certbotì´ ì‚¬ìš©í•  ë””ë ‰í† ë¦¬</span>
      <span class="pi">-</span> <span class="s">./nginx/ssl:/etc/letsencrypt</span> <span class="c1"># ssl ì¸ì¦ì„œ ì €ì¥ ë””ë ‰í† ë¦¬</span>
      <span class="pi">-</span> <span class="s">./nginx/logs:/var/log/nginx</span> <span class="c1"># nginx ë¡œê·¸ ì €ì¥ ë””ë ‰í† ë¦¬</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">honey-moa-dev</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">honey-moa-dev-network</span>

  <span class="na">certbot</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">certbot/certbot</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">certbot</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx/www/certbot:/var/www/certbot</span> <span class="c1"># certbotì´ ì‚¬ìš©í•  ë””ë ‰í† ë¦¬</span>
      <span class="pi">-</span> <span class="s">./nginx/ssl:/etc/letsencrypt</span> <span class="c1"># ssl ì¸ì¦ì„œ ì €ì¥ ë””ë ‰í† ë¦¬</span>
    <span class="na">entrypoint</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/bin/sh</span><span class="nv"> </span><span class="s">-c</span><span class="nv"> </span><span class="s">'trap</span><span class="nv"> </span><span class="s">exit</span><span class="nv"> </span><span class="s">TERM;</span><span class="nv"> </span><span class="s">while</span><span class="nv"> </span><span class="s">:;</span><span class="nv"> </span><span class="s">do</span><span class="nv"> </span><span class="s">certbot</span><span class="nv"> </span><span class="s">renew;</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">12h</span><span class="nv"> </span><span class="s">&amp;</span><span class="nv"> </span><span class="s">wait</span><span class="nv"> </span><span class="s">$${!};</span><span class="nv"> </span><span class="s">done;'"</span> <span class="c1"># ì¸ì¦ì„œ ìë™ ê°±ì‹ </span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">honey-moa-dev-network</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">honey-moa-dev-network</span><span class="pi">:</span> <span class="c1"># ë„¤íŠ¸ì›Œí¬ ì„¤ì •</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>
</code></pre></div></div>

<details>
<summary><b>docker-compose.yaml íŒŒì¼ ì„¤ëª…</b></summary>
<div>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì—ì„œ <code class="language-plaintext highlighter-rouge">honey-moa-dev</code>(ë°±ì—”ë“œ ì„œë²„), <code class="language-plaintext highlighter-rouge">nginx</code>, <code class="language-plaintext highlighter-rouge">certbot</code> ì„ ì •ì˜í•©ë‹ˆë‹¤.</li>
      <li>nginx ì„œë¹„ìŠ¤ëŠ” 80ë²ˆê³¼ 443ë²ˆ í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ê³ , ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¥¼ í†µí•´ nginx.conf íŒŒì¼ê³¼ ì¸ì¦ì„œ, ë¡œê·¸ ë””ë ‰í† ë¦¬ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.
        <ul>
          <li><code class="language-plaintext highlighter-rouge">depends_on:</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ Nginxê°€ ë°±ì—”ë“œ ì„œë²„ì— ì˜ì¡´í•˜ë„ë¡ ì„¤ì •í•˜ì—¬ ë°±ì—”ë“œ ì„œë²„ê°€ ì‹¤í–‰ëœ í›„ì— ì‹œì‘ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li><code class="language-plaintext highlighter-rouge">certbot</code> ì„œë¹„ìŠ¤ëŠ” <code class="language-plaintext highlighter-rouge">entrypoint</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ Certbotì´ 12ì‹œê°„ë§ˆë‹¤ ì¸ì¦ì„œë¥¼ ê°±ì‹ í•˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">networks:</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ <code class="language-plaintext highlighter-rouge">honey-moa-dev-network</code>ë¼ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ ìƒì„±í•˜ê³ , ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì´ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </div>
</details>

<h2 id="nginxconf-íŒŒì¼-ì—…ë°ì´íŠ¸">nginx.conf íŒŒì¼ ì—…ë°ì´íŠ¸</h2>

<p>ì¸ì¦ì„œ ë°œê¸‰ì´ ì™„ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ ìš”ì²­ì„ <code class="language-plaintext highlighter-rouge">HTTPS</code>ë¡œ ë°›ì„ ìˆ˜ ìˆë„ë¡ <code class="language-plaintext highlighter-rouge">nginx.conf</code> íŒŒì¼ë„ ì—…ë°ì´íŠ¸ í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># file: "nginx/nginx.conf"</span>
<span class="k">events</span> <span class="p">{</span>
  <span class="kn">worker_connections</span> <span class="mi">1024</span><span class="p">;</span> <span class="c1"># ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ê°€ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ì—°ê²° ìˆ˜</span>
<span class="p">}</span>

<span class="k">http</span> <span class="p">{</span>
  <span class="kn">upstream</span> <span class="s">backend</span> <span class="p">{</span>
      <span class="kn">server</span> <span class="nf">honey-moa-dev</span><span class="p">:</span><span class="mi">3000</span><span class="p">;</span> <span class="c1"># ë°±ì—”ë“œ ì»¨í…Œì´ë„ˆ ì—°ê²°</span>
  <span class="p">}</span>

  <span class="c1"># HTTPS ì„¤ì •</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">dev.honeymoa.kr</span><span class="p">;</span> <span class="c1"># server_name {ë„ë©”ì¸}</span>

    <span class="kn">ssl_certificate</span> <span class="n">/etc/letsencrypt/live/dev.honeymoa.kr/fullchain.pem</span><span class="p">;</span> <span class="c1"># SSL ì¸ì¦ì„œ ê²½ë¡œ</span>
    <span class="kn">ssl_certificate_key</span> <span class="n">/etc/letsencrypt/live/dev.honeymoa.kr/privkey.pem</span><span class="p">;</span> <span class="c1"># SSL ê°œì¸í‚¤ ê²½ë¡œ</span>

    <span class="kn">ssl_protocols</span> <span class="s">TLSv1.2</span> <span class="s">TLSv1.3</span><span class="p">;</span>
    <span class="kn">ssl_ciphers</span> <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>

    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
      <span class="kn">proxy_pass</span> <span class="s">http://backend</span><span class="p">;</span>
      <span class="kn">proxy_http_version</span> <span class="mf">1.1</span><span class="p">;</span>
      <span class="kn">proxy_set_header</span> <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
      <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">'upgrade'</span><span class="p">;</span>
      <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
      <span class="kn">proxy_cache_bypass</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1"># HTTP -&gt; HTTPS ë¦¬ë””ë ‰ì…˜ ì„¤ì •</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">dev.honeymoa.kr</span><span class="p">;</span> <span class="c1"># server_name {ë„ë©”ì¸}</span>

    <span class="kn">location</span> <span class="n">/.well-known/acme-challenge/</span> <span class="p">{</span>
      <span class="kn">root</span> <span class="n">/var/www/certbot</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<details>
<summary><b>nginx.conf íŒŒì¼ ì„¤ëª…</b></summary>
<div>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">upstream backend</code> ë¸”ë¡ì€ ë°±ì—”ë“œ ì„œë²„ì˜ ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        <ul>
          <li>ì—¬ê¸°ì„œëŠ” <code class="language-plaintext highlighter-rouge">honey-moa-dev:3000</code>ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code>ì—ì„œ ì •ì˜í–ˆë˜ ì„œë¹„ìŠ¤ ì´ë¦„ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ì²«ë²ˆì§¸ <code class="language-plaintext highlighter-rouge">server</code> ë¸”ë¡ì€ HTTPS ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        <ul>
          <li><code class="language-plaintext highlighter-rouge">listen 443 ssl;</code>ì€ 443ë²ˆ í¬íŠ¸ë¥¼ SSLë¡œ ë¦¬ìŠ¤ë‹í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.</li>
          <li><code class="language-plaintext highlighter-rouge">ssl_certificate</code>ì™€ <code class="language-plaintext highlighter-rouge">ssl_certificate_key</code>ëŠ” ë°œê¸‰ë°›ì€ SSL ì¸ì¦ì„œì™€ ê°œì¸í‚¤ì˜ ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</li>
          <li><code class="language-plaintext highlighter-rouge">ssl_protocols</code>ì™€ <code class="language-plaintext highlighter-rouge">ssl_ciphers</code>ëŠ” SSL í”„ë¡œí† ì½œê³¼ ì•”í˜¸í™” ë°©ì‹ì„ ì„¤ì •í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li><code class="language-plaintext highlighter-rouge">location /</code> ë¸”ë¡ì€ ëª¨ë“  ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ë¡œ í”„ë¡ì‹œ íŒ¨ìŠ¤í•©ë‹ˆë‹¤.
        <ul>
          <li><code class="language-plaintext highlighter-rouge">proxy_pass</code>ëŠ” ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.</li>
          <li><code class="language-plaintext highlighter-rouge">proxy_set_header</code>ëŠ” ìš”ì²­ í—¤ë”ë¥¼ ì„¤ì •í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ ì •ë³´ë¥¼ ë°±ì—”ë“œ ì„œë²„ì— ì „ë‹¬í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ë‘ë²ˆì§¸ <code class="language-plaintext highlighter-rouge">server</code> ë¸”ë¡ì€ HTTP ìš”ì²­ì„ HTTPSë¡œ ë¦¬ë””ë ‰ì…˜í•©ë‹ˆë‹¤.</li>
    </ul>
  </div>
</details>

<h2 id="docker-compose-ì‹¤í–‰">docker-compose ì‹¤í–‰</h2>
<p>ì´ì œ ëª¨ë“  ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìœ¼ë‹ˆ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•´ë´…ì‹œë‹¤!</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose up <span class="nt">-d</span>
</code></pre></div></div>
<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/docker-compose-up.png" alt="docker-compose ì‹¤í–‰" />
<br /></p>

<p><code class="language-plaintext highlighter-rouge">Nginx</code> ì»¨í…Œì´ë„ˆê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># nginx.conf íŒŒì¼ ë¬¸ë²• ê²€ì‚¬</span>
<span class="nv">$ </span>docker-compose <span class="nb">exec </span>nginx nginx <span class="nt">-t</span>

<span class="c"># HTTPS ìš”ì²­ í™•ì¸</span>
<span class="c"># curl -I https://{ë„ë©”ì¸}</span>
<span class="nv">$ </span>curl <span class="nt">-I</span> https://dev.honeymoa.kr
</code></pre></div></div>
<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/docker-compose-nginx-check.png" alt="docker-compose nginx ì‹¤í–‰ í™•ì¸" />
<br /></p>

<p><code class="language-plaintext highlighter-rouge">Certbot</code> ì»¨í…Œì´ë„ˆê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># certbot ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í™•ì¸</span>
<span class="nv">$ </span>docker logs certbot
</code></pre></div></div>
<p><img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/aws/2025-03-07-AWS-EC2ì—ì„œ-Nginxì™€-Certbotìœ¼ë¡œ-Lets-encrypt-SSL-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°/docker-compose-certbot-check.png" alt="docker-compose certbot ì‹¤í–‰ í™•ì¸" />
<br /></p>

<p>ê° ì»¨í…Œì´ë„ˆë“¤ì˜ ì‹¤í–‰ í™•ì¸ê¹Œì§€ ë§ˆì¹˜ì…¨ë‹¤ë©´ SSL ì¸ì¦ì„œ ì ìš© í›„, Certbotì„ ì´ìš©í•œ ìë™ ê°±ì‹ ê¹Œì§€ ì™„ì„±ì…ë‹ˆë‹¤! ğŸ‰</p>

<h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°</h2>

<p>ì˜¤ëŠ˜ì€ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ Nginxì™€ Certbotì„ ì‚¬ìš©í•˜ì—¬ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ê³  ìë™ê°±ì‹ ê¹Œì§€ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.
ì²˜ìŒ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ëŠ” ê³¼ì •ì„ ì ‘í•œë‹¤ë©´ ìƒì†Œí•˜ê³ , íŠ¹íˆ <code class="language-plaintext highlighter-rouge">nginx.conf</code> íŒŒì¼ê³¼ <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> íŒŒì¼ì„ ì‘ì„±í•˜ëŠ” ë¶€ë¶„ì—ì„œ ì–´ë ¤ì›€ì„ ëŠë¼ì‹¤ ìˆ˜ ìˆëŠ”ë°ìš”. ì¡°ê¸‰í•´ í•˜ì§€ ë§ê³  ì°¨ê·¼ì°¨ê·¼ ê° ë‹¨ê³„ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ì—¬ëŸ¬ë²ˆ ì ìš©í•´ë³´ë©´ ê¸ˆë°© ìµìˆ™í•´ì§ˆ ìˆ˜ ìˆì„ê²ë‹ˆë‹¤.</p>

<p>ê·¸ëŸ¼ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤! ë¾°ë¡œë¡±~
<br />
<br />
<img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/frieren1.gif" width="300" height="300" alt="í”„ë¦¬ë Œ ì›€ì§¤1" /></p>

  
</article>



  <hr class="dingbat related mb6" />


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D9VF7EQWGG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-D9VF7EQWGG');
</script>




  
     



  

  
  

  
    


  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Related Posts</h2>  <ul class="related-posts">                  <li class="h4">  <a href="/docker/2024/04/03/Docker-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-for-macOS.html" class="flip-title"><span>Docker ì„¤ì¹˜í•˜ê¸° for macOS</span></a>  <time class="faded fine" datetime="2024-04-03T15:50:00+09:00">2024-04-03 15:50</time></li>                        <li class="h4">  <a href="/nestjs/2024/03/29/NestJS-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0.html" class="flip-title"><span>NestJS ì„¤ì¹˜ ë° ì‹œì‘í•˜ê¸°</span></a>  <time class="faded fine" datetime="2024-03-29T09:57:00+09:00">2024-03-29 09:57</time></li>                        <li class="h4">  <a href="/nestjs/2024/03/22/NestJS%EB%A5%BC-%EC%84%A0%ED%83%9D%ED%95%9C-%EC%9D%B4%EC%9C%A0.html" class="flip-title"><span>NestJSë¥¼ ì„ íƒí•œ ì´ìœ  (NestJSë€?)</span></a>  <time class="faded fine" datetime="2024-03-22T21:20:00+09:00">2024-03-22 21:20</time></li>            </ul></aside>

  

  
  

  
    
<aside class="comments related" role="complementary">
  <h2 class="hr-bottom">Comments</h2>
  <!-- 
 -->
<script src="https://giscus.app/client.js"
        data-repo="NicoDora/NicoDora.github.io"
        data-repo-id="R_kgDOLeHHqA"
        data-category="Comments"
        data-category-id="DIC_kwDOLeHHqM4CeGWL"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="dark_dimmed"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</aside>


  

  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">Â© 2024 NicoDora. All rights reserved.
</small></p>
  
  
    <p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">9.1.6</span></small></p>
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg sidebar-overlay" style="background-color:rgb(25,55,71);background-image:url(https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/sidebar-bg.jpg)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="https://cdn.jsdelivr.net/gh/NicoDora/nicodora.github.io/assets/img/logo.png" class="avatar" alt="NicoDora" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h2">NicoDora</h2></a>
    
    
      <p class="">
        keep moving

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/"
          class="sidebar-nav-item "
          
        >
          Home
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/nestjs/"
          class="sidebar-nav-item "
          
        >
          NestJS
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/aws/"
          class="sidebar-nav-item "
          
        >
          AWS
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/docker/"
          class="sidebar-nav-item "
          
        >
          Docker
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social</span>
<ul>
  
    
    

    
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/NicoDora" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    

    
    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
  <script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
  

  
  <script>!function(w, d) {
    w.ga=w.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    /**/
      if (navigator.CookiesOK) {
        ga('create', 'G-D9VF7EQWGG', 'auto');
      } else if (d.cookie.indexOf("hy--cookies-ok=true") > -1) {
        ga('create', 'G-D9VF7EQWGG', {
          'storage': 'none',
          'clientId': localStorage ? localStorage.getItem('ga--client-id') : undefined
        });
      } else {
        ga('create', 'G-D9VF7EQWGG', {
          'storage': 'none'
        });
        ga('set', 'forceSSL', true);
        ga('set', 'anonymizeIp', true);
      }
    /**/

    var pushStateEl = d.getElementById('_pushState');
    var timeoutId;
    pushStateEl.addEventListener('hy-push-state-load', function() {
      w.clearTimeout(timeoutId);
      timeoutId = w.setTimeout(function() {
        ga('set', 'page', w.location.pathname);
        ga('send', 'pageview');
      }, 500);
    });

    d.addEventListener('hy--cookies-ok', function () {
      w.ga(function(tracker) {
        w.ga("set", "anonymizeIp", undefined);
        localStorage && localStorage.setItem("ga--client-id", tracker.get("clientId"));
      });
    });

    w.loadJSDeferred('https://www.google-analytics.com/analytics.js');
  }(window, document);</script>


<!--<![endif]-->
  



<div hidden>
  
  <h2 class="sr-only">Templates:</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loadingâ€¦</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h2 class="page-title">Error</h2>
    
    
    <p class="lead">
      Sorry, an error occurred while loading: <a class="this-link" href=""></a>.
    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_cookies-banner-template">
  <div id="_cookies-banner" class="navbar fixed-bottom CookiesOK">
    <div class="content">
      <div class="nav-btn-bar">
        <small class="faded">
          <span>This site uses cookies.
</span>
          <button id="_cookies-ok" class="btn btn-primary btn-sm">Okay</button>
        </small>
      </div>
    </div>
  </div>
</template>

  
  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
  
    <template id="_search-template">
  <button id="_search" class="nav-btn no-hover">
    <label class="sr-only" for="_search-input">Search</label>
    <span class="icon-search"></span>
  </button>
  <div id="_search-box">
    <div class="nav-btn">
      <span class="icon-search"></span>
    </div>
    <input
      id="_search-input"
      type="search"
      class="form-control form-control-lg nav-btn"
      placeholder="Build with JEKYLL_ENV=production to enable search."
    />
    <button type="reset" class="nav-btn no-hover">
      <span class="sr-only">Close</span>
      <span class="icon-cross"></span>
    </button>
  </div>
  <div id="_hits"></div>
</template>

  
</div>


</body>
</html>
